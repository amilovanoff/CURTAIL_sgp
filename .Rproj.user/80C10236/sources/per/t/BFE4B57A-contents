# Scenarios -----------------------------------

#Default output in default scenario. Do for all except functions with implicit attributes
function_attributes <- read.csv("architecture/function_attributes.csv",stringsAsFactors = FALSE)
function_tbc <- setdiff(unique(function_attributes$Function),c(unique(subset(function_attributes,Type=="Implicit")$Function),"rapid_transit_module_f","transport_activity_f","transport_activity_initialize_f","optimization_pathway_f"))
function_tbc <- "transport_veh_pop_f"
do.call(write_def_outputs_f,list(function_tbc=function_tbc,scen_tbc="def"))
do.call(write_def_outputs_f,list(function_tbc="transport_activity_f",scen_tbc="def"))

do.call(write_def_outputs_f,list(function_tbc="transport_activity_f",scen_tbc="scen1"))
do.call(write_def_outputs_f,list(function_tbc="transport_veh_pop_f",scen_tbc="scen1"))
do.call(write_def_outputs_f,list(function_tbc="transport_fuel_use_f",scen_tbc="scen1"))
do.call(write_def_outputs_f,list(function_tbc="transport_lca_ghg_f",scen_tbc="scen1"))

do.call(write_def_outputs_f,list(function_tbc="transport_lca_ghg_f",scen_tbc="def"))


do.call(write_def_outputs_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_travel_demand_2c"))
do.call(write_def_outputs_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_travel_demand_15c"))
do.call(write_def_outputs_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_modal_share_2c"))
do.call(write_def_outputs_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_modal_share_15c"))

do.call(write_def_outputs_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_technology_2c"))
do.call(write_def_outputs_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_electricity_2c"))

do.call(write_def_outputs_f,list(function_tbc="transport_lca_ghg_budget_f",scen_tbc="budget"))

# Simulations -------------------------------------------------------------

do.call(write_simulation_f,list(function_tbc="transport_lca_ghg_f",scen_tbc="def",sim_tbc="sim1",sim_type="continuous"))
do.call(write_simulation_f,list(function_tbc="transport_lca_ghg_f",scen_tbc="scen1",sim_tbc="sim1",sim_type="discrete"))

do.call(write_simulation_f,list(function_tbc="optimization_pathway_f",scen_tbc="optimization_electricity_2c",sim_tbc="sim1",sim_type="continuous"))
do.call(write_simulation_f,list(function_tbc="transport_lca_ghg_f",scen_tbc="electricity",sim_tbc="sim2",sim_type="continuous"))
do.call(write_simulation_f,list(function_tbc="transport_lca_ghg_f",scen_tbc="optimization_electricity_2c",sim_tbc="sim3",sim_type="continuous"))

# Single factor sensivity analysis ------------------------------------------------------

sens_a_tbc <- paste0("sens",c(2:5))
for (sens in sens_a_tbc){
  do.call(write_sens_analysis_f,list(sens_tbc=sens,function_tbc="model_climate_target_f",scen_tbc="seek_bev",get_default_attr_val="n"))
}

do.call(write_sens_analysis_f,list(sens_tbc="uncer1",
                                   function_tbc="model_climate_target_f",
                                   scen_tbc="seek_bev",
                                   get_default_attr_val="n"))

do.call(write_sens_analysis_f,list(sens_tbc="uncer2",
                                   function_tbc="model_climate_target_f",
                                   scen_tbc="seek_bev",
                                   get_default_attr_val="n"))


scen_tbc <- paste0("scen",c(1,2,6))
for (scen in scen_tbc){
  do.call(write_sens_analysis_f,list(sens_tbc=scen,
                                     function_tbc="model_climate_target_f",
                                     scen_tbc="seek_bev",
                                     get_default_attr_val="n"))
}

# Multi-factor sensitivity analysis ---------------------------------------

do.call(write_multi_factor_sens_a_f,list(function_to_write="model_climate_target_f",
                                         mf_sens_tbc="mfsens1",
                                         scen_tbc="seek_bev",
                                         sens_tbc="uncer2",
                                         base_folder = "functions"))

do.call(write_multi_factor_sens_a_f,list(function_to_write="model_climate_target_f",
                                         mf_sens_tbc="mfsens2",
                                         scen_tbc="seek_bev",
                                         sens_tbc="uncer2",
                                         base_folder = "functions"))


scen_tbc <- paste0("scen",c(1,2,6))
for (scen in scen_tbc){
  do.call(write_multi_factor_sens_a_f,list(function_to_write="model_climate_target_f",
                                           mf_sens_tbc="mfsens1",
                                           scen_tbc="seek_bev",
                                           sens_tbc=scen,
                                           base_folder = "functions"))
  
  do.call(write_multi_factor_sens_a_f,list(function_to_write="model_climate_target_f",
                                           mf_sens_tbc="mfsens1",
                                           scen_tbc="seek_bev",
                                           sens_tbc=c(scen,"uncer2"),
                                           base_folder = "functions"))
}
