"0","res <- read_def_outputs_f(function_tbc=""transport_veh_pop_f"",scen_tbc=""def"")"
"0","dt <- res[[""transport_veh_pop_dt""]]"
"0","year_tbc <- 2005:2019"
"0","transport_modes <- unique(dt$Mode)"
"0","car_techno_order <- c(""ICEV-G"",""ICEV-D"",""HEV-G"",""HEV-D"",""CNG"",""PHEV"",""BEV"")"
"0","moto_techno_order <- c(""ICEM-G"",""EM"")"
"0","bus_techno_order <- c(""ICEB-G"",""ICEB-D"",""HEB-G"",""HEB-D"",""CNGB"",""EB"")"
"0","#Color by technology"
"0","color_car <- c(""ICEV-G""=""#1f78b4"",""ICEV-D""=""#d95f02"",""HEV-G""=""#a6cee3"",""HEV-D""=""#fdbf6f"",""CNG""=""#bebada"",""PHEV""=""#b2df8a"",""BEV""=""#33a02c"")"
"0","color_moto <- c(""ICEM-G""=""#1f78b4"",""EM""=""#33a02c"")"
"0","color_bus <- c(""ICEB-G""=""#1f78b4"",""ICEB-D""=""#d95f02"",""HEB-G""=""#a6cee3"",""HEB-D""=""#fdbf6f"",""CNGB""=""#bebada"",""EB""=""#33a02c"")"
"0","for (mode in transport_modes) {"
"0","  plot_dt <- subset(dt,Mode==mode & Year%in%year_tbc)"
"0","  #Techno order"
"0","  techno_order_name <- switch(mode,"
"0","                              `Private car`=""car_techno_order"","
"0","                              `Private hire car`=""car_techno_order"","
"0","                              `Taxi`=""car_techno_order"","
"0","                              Motorcycle = ""moto_techno_order"","
"0","                              `Public bus` = ""bus_techno_order"","
"0","                              `Private bus` = ""bus_techno_order"","
"0","                              `School bus` = ""bus_techno_order"")"
"0","  techno_order <- get(techno_order_name)"
"0","  #color"
"0","  color_value_name <- switch(mode,"
"0","                              `Private car`=""color_car"","
"0","                              `Private hire car`=""color_car"","
"0","                              `Taxi`=""color_car"","
"0","                              Motorcycle = ""color_moto"","
"0","                              `Public bus` = ""color_bus"","
"0","                              `Private bus` = ""color_bus"","
"0","                              `School bus` = ""color_bus"")"
"0","  color_values <- get(color_value_name)"
"0","  plot_dt$Technology <- factor(plot_dt$Technology, levels=techno_order)"
"0","  "
"0","  ggplot()+"
"0","  geom_col(data=plot_dt,"
"0","           aes(x=Year,y=Value/10^3,fill=Technology))+"
"0","  facet_wrap(~Mode)+"
"0","  scale_fill_manual(values=color_values,guide=guide_legend(title=NULL))+"
"0","  scale_y_continuous(expand = c(0.01,0))+"
"0","  scale_x_continuous(expand = c(0.01,0),breaks = c(2005,2010,2015,2019))+"
"0","  labs(x=NULL,y=""Vehicle population \n (thousand vehicles)"")+"
"0","  theme_milovanoff(legend_position = ""right"")"
"0","  #Save"
"0","  ggsave(paste0(""outputs/plots/si/hist_veh_pop_"",mode,"".png""),width=word_width,height=2,units=c(""in""),dpi=600)"
"0","}"
"0",""
